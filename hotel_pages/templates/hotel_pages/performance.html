<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Parallel Computing Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background-color: #000000; color: #f8f9fa; font-family: 'Segoe UI', sans-serif; padding: 30px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #2c3034; padding-bottom: 15px; }
        .card { background: #2c3034; border: 1px solid #3e444a; border-radius: 15px; padding: 25px; margin-bottom: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h1, h2, h3 { color: #0dcaf0; font-weight: 300; }
        .metric-card { text-align: center; padding: 20px; }
        .metric-value { font-size: 2.8rem; font-weight: bold; color: #ffc107; }
        .metric-label { font-size: 0.9rem; color: #adb5bd; text-transform: uppercase; letter-spacing: 1px; }
        .btn-nav { padding: 12px 24px; background: #198754; color: white; text-decoration: none; border-radius: 8px; font-weight: bold; transition: 0.3s; border: none; }
        .btn-nav:hover { background: #157347; transform: translateY(-2px); color: white; }
        .table-custom { width: 100%; color: white; border-collapse: collapse; margin-top: 20px; }
        .table-custom th, .table-custom td { padding: 12px; border: 1px solid #3e444a; text-align: center; }
        .table-custom th { background: #1a1d20; color: #0dcaf0; }
        .highlight { color: #0dcaf0; font-weight: bold; }
    </style>
</head>
<body>

    <div class="header">
        <h1>System Performance <small style="color: #6c757d;">Multithreading Experiment</small></h1>
        <a href="{% url 'dashboard_v1' %}" class="btn-nav">‚Üê Back to Analytics</a>
    </div>

    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card metric-card">
                <div class="metric-label">Synchronous Time (1 Thread)</div>
                <div class="metric-value">{{ sync_time }}s</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card metric-card" style="border-color: #ffc107;">
                <div class="metric-label">Best Parallel Time</div>
                <div class="metric-value">{{ para_time }}s</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card metric-card">
                <div class="metric-label">Speedup Factor</div>
                <div class="metric-value">x{{ speedup }}</div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <h2>Execution Time vs. Thread Count</h2>
                <div style="height: 400px;">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card">
                <h3>Experiment Data</h3>
                <table class="table-custom">
                    <thead>
                        <tr>
                            <th>Threads</th>
                            <th>Time (sec)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for count in thread_counts %}
                        <tr>
                            <td>{{ count }} Workers</td>
                            <td class="highlight">{{ execution_times|slice:forloop.counter0|first }}s</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <p class="mt-4 text-muted small">
                    Test Scenario: Executing 100 complex database queries using
                    <code style="color: #ffc107;">ThreadPoolExecutor</code> with varied worker settings.
                </p>
            </div>
        </div>
    </div>

    <div class="card">
        <h3>Technical Summary</h3>
        <p>
            This experiment demonstrates the impact of parallel processing on database interaction.
            By splitting tasks across multiple threads, we minimize the CPU idle time during I/O operations.
            The <span class="highlight">optimal thread count</span> is determined where the execution time reaches its minimum
            before the overhead of thread management starts to decrease efficiency.
        </p>
    </div>

    <script>
        const ctx = document.getElementById('performanceChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: {{ thread_counts|safe }},
                datasets: [{
                    label: 'Execution Time (Seconds)',
                    data: {{ execution_times|safe }},
                    borderColor: '#0dcaf0',
                    backgroundColor: 'rgba(13, 202, 240, 0.1)',
                    borderWidth: 4,
                    pointBackgroundColor: '#ffc107',
                    pointRadius: 6,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        grid: { color: '#3e444a' },
                        ticks: { color: '#adb5bd' }
                    },
                    x: {
                        grid: { color: '#3e444a' },
                        ticks: { color: '#adb5bd' }
                    }
                },
                plugins: {
                    legend: { labels: { color: 'white' } }
                }
            }
        });
    </script>
</body>
</html>